═══════════════════════════════════════════════════════════════════════════════
                        Claude 对话历史查看工具 - 快速指南
═══════════════════════════════════════════════════════════════════════════════

📊 你的对话统计:
   • 总消息数: 6,141 条
   • 用户消息: 2,232 条
   • 助手消息: 3,909 条
   • 时间跨度: 从 2025-12-04 到现在
   • 会话数量: 25 个

───────────────────────────────────────────────────────────────────────────────
🚀 常用命令
───────────────────────────────────────────────────────────────────────────────

1️⃣  查看统计信息（最快）
   python3 chat_stats.py

2️⃣  查看最近的对话（推荐，包含工具调用，去除重复）
   python3 view_chat_history.py --limit 50 --no-thinking --deduplicate

3️⃣  只看文字对话（最简洁）
   python3 view_chat_history.py --limit 50 --no-thinking --no-tools --deduplicate

3.5 查看对话并截断长输出（方便快速浏览）
   python3 view_chat_history.py --limit 50 --no-thinking --truncate

4️⃣  导出完整历史记录（包含所有内容）
   python3 view_chat_history.py --export 完整对话历史.txt

5️⃣  导出最近的对话（不含思考过程）
   python3 view_chat_history.py --limit 100 --no-thinking --export 最近对话.txt

6️⃣  查看所有对话（包含思考过程和工具）
   python3 view_chat_history.py | less

───────────────────────────────────────────────────────────────────────────────
🔍 搜索对话内容
───────────────────────────────────────────────────────────────────────────────

先导出，再搜索：

   # 导出所有对话
   python3 view_chat_history.py --export all.txt

   # 搜索关键词
   grep -i "关键词" all.txt

   # 搜索并显示上下文
   grep -i -C 5 "关键词" all.txt

───────────────────────────────────────────────────────────────────────────────
📋 显示内容说明
───────────────────────────────────────────────────────────────────────────────

脚本会显示：
✅ 对话文字（用户和助手的文本消息）
✅ 思考过程（Claude的内部推理，加 --no-thinking 隐藏）
✅ 工具调用（Claude使用的工具，如Bash、Read、Edit等）
✅ 工具输出（工具执行的结果）

示例：
┌─ 🔧 工具调用: Bash [工具ID]
│  命令: ls -lah
│  说明: List files
└─

┌─ ✅ 工具输出 [工具ID]
│  total 18M
│  drwx------ 2 root root 4.0K
│  ...
└─

───────────────────────────────────────────────────────────────────────────────
💡 实用技巧
───────────────────────────────────────────────────────────────────────────────

• 只看文字对话，不要思考过程和工具:
  python3 view_chat_history.py --no-thinking --no-tools

• 查看工具操作历史（了解Claude做了什么）:
  python3 view_chat_history.py --no-thinking --limit 100

• 查看特定日期的对话:
  python3 view_chat_history.py --export temp.txt
  grep "2025-12-08" temp.txt

• 导出文件自动添加日期:
  python3 view_chat_history.py --export "对话记录_$(date +%Y%m%d).txt"

• 在文本编辑器中查看（更舒适）:
  python3 view_chat_history.py --export history.txt
  # 然后用任何文本编辑器打开 history.txt

• 查看某个会话的完整工具调用记录:
  python3 view_chat_history.py --session 会话ID --no-thinking

───────────────────────────────────────────────────────────────────────────────
📁 文件说明
───────────────────────────────────────────────────────────────────────────────

view_chat_history.py    - 主程序（查看和导出对话）
chat_stats.py           - 统计脚本（快速查看统计信息）
README_CHAT_HISTORY.md  - 详细使用文档
快速使用.txt            - 本文件（快速参考）

───────────────────────────────────────────────────────────────────────────────
🎯 推荐工作流
───────────────────────────────────────────────────────────────────────────────

每天使用:
1. python3 chat_stats.py  # 查看今天聊了多少
2. python3 view_chat_history.py --limit 20  # 回顾最近对话

每周备份:
python3 view_chat_history.py --export "备份_$(date +%Y年%m月%d日).txt"

需要查找某次对话:
1. python3 view_chat_history.py --export temp.txt
2. grep -i "你记得的关键词" temp.txt

───────────────────────────────────────────────────────────────────────────────
⚠️  注意事项
───────────────────────────────────────────────────────────────────────────────

• 导出的文件可能会很大（几十MB），注意存储空间
• 默认不包含 agent-* 文件（子代理对话），如需包含加 --include-agents
• 思考过程很长，日常查看建议加 --no-thinking
• 所有消息已按时间排序，即使它们来自不同文件

⭐ 新功能提示:
• --deduplicate: 去除重复消息（移除了 2408 条重复，从 5118 → 2710）
  原因：不同session文件可能有交叉内容，这是正常现象
• --truncate: 截断长输出（默认显示完整内容）
  - 思考过程：最多20行
  - 工具输出：最多30行
  - 适合快速浏览，不适合详细查看
• 智能颜色输出（自动检测，v3.0新增）
  - 用户消息：红色（醒目）
  - 助手消息：蓝色
  - 思考过程：暗淡灰色（不重要）
  - 工具调用：黄色
  - 工具输出：青色
  - 加 --no-color 可禁用

───────────────────────────────────────────────────────────────────────────────

需要帮助？查看详细文档:
cat README_CHAT_HISTORY.md

═══════════════════════════════════════════════════════════════════════════════
