═══════════════════════════════════════════════════════════════════════════════
                    Claude 对话历史查看工具 - 功能演示
═══════════════════════════════════════════════════════════════════════════════

这个文件展示了对话历史工具的主要功能和输出格式。

───────────────────────────────────────────────────────────────────────────────
📊 1. 查看统计信息
───────────────────────────────────────────────────────────────────────────────

命令: python3 chat_stats.py

输出示例:
================================================================================
对话历史统计信息
================================================================================

📁 文件统计:
   主会话文件: 25 个
   代理文件: 58 个
   总计: 83 个文件

💬 消息统计:
   用户消息: 2,232 条
   助手消息: 3,909 条
   总计: 6,141 条消息

🔗 会话统计:
   不同会话: 25 个

📅 时间跨度:
   最早消息: 2025-12-04 10:20:46
   最新消息: 2025-12-11 08:59:37
   跨度: 6 天

📊 每日消息数（最近10天）:
   2025-12-08: 1905 条 ████████████████████
   2025-12-05: 1938 条 ████████████████████

───────────────────────────────────────────────────────────────────────────────
💬 2. 查看对话内容（完整模式）
───────────────────────────────────────────────────────────────────────────────

命令: python3 view_chat_history.py --limit 2

输出格式:
────────────────────────────────────────────────────────────────────────────────
[1] 👤 用户 - 2025-12-04 10:42:20
会话: d58a6bc3... | 文件: d58a6bc3-b93c-427d-8ec0-b052f91f76ee.jsonl
────────────────────────────────────────────────────────────────────────────────
现在目录下有个项目，jax-dna，请你把它迁移到当前的硬件平台上


────────────────────────────────────────────────────────────────────────────────
[2] 🤖 助手 - 2025-12-04 10:42:25
会话: d58a6bc3... | 文件: d58a6bc3-b93c-427d-8ec0-b052f91f76ee.jsonl
────────────────────────────────────────────────────────────────────────────────

╔══ 💭 思考过程 ══╗
║ 用户要求将jax-dna项目迁移到当前硬件平台...
║ 我需要先了解项目结构...
╚════════════════════════════════════════════════════════════════════════════╝

我来帮你将jax-dna项目迁移到华为Ascend NPU平台...

┌─ 🔧 工具调用: Bash [toolu_01ABCD]
│  命令: ls -lah
│  说明: List directory contents
└─

───────────────────────────────────────────────────────────────────────────────
💬 3. 查看对话内容（简洁模式 - 无思考无工具）
───────────────────────────────────────────────────────────────────────────────

命令: python3 view_chat_history.py --limit 2 --no-thinking --no-tools

输出格式:
────────────────────────────────────────────────────────────────────────────────
[1] 👤 用户 - 2025-12-04 10:42:20
会话: d58a6bc3... | 文件: d58a6bc3-b93c-427d-8ec0-b052f91f76ee.jsonl
────────────────────────────────────────────────────────────────────────────────
现在目录下有个项目，jax-dna，请你把它迁移到当前的硬件平台上


────────────────────────────────────────────────────────────────────────────────
[2] 🤖 助手 - 2025-12-04 10:42:25
会话: d58a6bc3... | 文件: d58a6bc3-b93c-427d-8ec0-b052f91f76ee.jsonl
────────────────────────────────────────────────────────────────────────────────
我来帮你将jax-dna项目迁移到华为Ascend NPU平台...

───────────────────────────────────────────────────────────────────────────────
🔧 4. 工具调用和输出显示
───────────────────────────────────────────────────────────────────────────────

工具调用格式（🔧图标）:

┌─ 🔧 工具调用: Bash [toolu_01ABCD]
│  命令: git status
│  说明: Check git status
└─

┌─ 🔧 工具调用: Read [toolu_01EFGH]
│  文件: /path/to/file.py
└─

┌─ 🔧 工具调用: Edit [toolu_01IJKL]
│  文件: /path/to/file.py
│  修改: 150 → 180 字符
└─

┌─ 🔧 工具调用: Write [toolu_01MNOP]
│  文件: /path/to/newfile.py
│  内容长度: 2500 字符
└─

┌─ 🔧 工具调用: Task [toolu_01QRST]
│  任务: Migrate energy modules
│  代理: general-purpose
└─

工具输出格式（✅图标）:

┌─ ✅ 工具输出 [toolu_01ABCD]
│  On branch main
│  Your branch is up to date with 'origin/main'.
│
│  Changes not staged for commit:
│    modified:   file1.py
│    modified:   file2.py
└─

┌─ ✅ 工具输出 [toolu_01EFGH]
│  (显示前 30 行，共 233 行)
│       1→import torch
│       2→import torch.nn as nn
│       3→
│       4→class Model(nn.Module):
│       5→    def __init__(self):
│  ... (还有 203 行)
└─

───────────────────────────────────────────────────────────────────────────────
🎯 5. 查看特定会话
───────────────────────────────────────────────────────────────────────────────

命令: python3 view_chat_history.py --session 91f9be77 --no-thinking --limit 5

作用:
• 只显示特定会话ID的消息
• 可以追踪某一次对话的完整过程
• 可以查看特定任务的所有工具调用

───────────────────────────────────────────────────────────────────────────────
📤 6. 导出功能
───────────────────────────────────────────────────────────────────────────────

命令: python3 view_chat_history.py --export my_history.txt

生成的文件格式:
Claude Code 对话历史记录
导出时间: 2025-12-11 17:50:38
总消息数: 5118
================================================================================

────────────────────────────────────────────────────────────────────────────────
[1] 用户 - 2025-12-04 10:42:20
会话: d58a6bc3-b93c-427d-8ec0-b052f91f76ee | 文件: ...
────────────────────────────────────────────────────────────────────────────────

现在目录下有个项目，jax-dna，请你把它迁移到当前的硬件平台上

[... 更多消息 ...]

───────────────────────────────────────────────────────────────────────────────
🔍 7. 搜索和过滤
───────────────────────────────────────────────────────────────────────────────

搜索关键词:
python3 view_chat_history.py --export temp.txt
grep -i "pytorch" temp.txt

搜索特定日期:
grep "2025-12-08" temp.txt

搜索工具调用:
grep "工具调用: Bash" temp.txt
grep "工具调用: Edit" temp.txt

带上下文搜索:
grep -C 5 "关键词" temp.txt

───────────────────────────────────────────────────────────────────────────────
📝 8. 不同的使用场景
───────────────────────────────────────────────────────────────────────────────

场景1: 快速回顾今天的对话
python3 chat_stats.py
python3 view_chat_history.py --limit 20 --no-thinking

场景2: 查找Claude执行了哪些命令
python3 view_chat_history.py --no-thinking | grep "🔧 工具调用: Bash"

场景3: 查看某次代码修改的详细过程
python3 view_chat_history.py --session 会话ID --no-thinking

场景4: 导出完整历史用于备份
python3 view_chat_history.py --export "备份_$(date +%Y%m%d).txt"

场景5: 只看纯文字对话
python3 view_chat_history.py --no-thinking --no-tools --limit 50

───────────────────────────────────────────────────────────────────────────────
✨ 9. 高级特性
───────────────────────────────────────────────────────────────────────────────

✅ 自动时间排序
   - 即使消息来自不同文件，也会按时间顺序显示

✅ 智能长度限制
   - 思考过程: 最多显示20行
   - 工具输出: 最多显示30行
   - 每行: 最多120字符
   - 避免输出过长影响阅读

✅ 图标和格式化
   - 👤 用户消息
   - 🤖 助手消息
   - 💭 思考过程
   - 🔧 工具调用
   - ✅ 工具输出
   - 清晰的边框和分隔符

✅ 支持的工具类型
   - Bash: 显示命令和说明
   - Read/Write/Edit: 显示文件路径和内容信息
   - Glob/Grep: 显示搜索模式
   - Task: 显示任务描述和代理类型
   - 其他工具: 显示所有参数

───────────────────────────────────────────────────────────────────────────────
📌 10. 使用建议
───────────────────────────────────────────────────────────────────────────────

日常使用:
✓ 每天运行一次 chat_stats.py 查看统计
✓ 使用 --no-thinking 参数提高阅读效率
✓ 工具输出很有价值，建议保留显示

性能优化:
✓ 使用 --limit 参数限制消息数量
✓ 导出后再搜索，比每次都加载要快
✓ 不需要查看时，用 --no-tools 跳过工具输出

备份策略:
✓ 每周导出一次完整历史
✓ 重要会话单独导出
✓ 使用日期命名备份文件

═══════════════════════════════════════════════════════════════════════════════
